---
title: 流量拓扑
permalink: /features/enterprise-features/dashboard/panel/topology/
---
# 流量拓扑

DeepFlow 的流量拓扑可用于展示服务或资源之间的依赖关系，以便更好地分析和解决问题，例如分析性能瓶颈、单点故障或潜在的依赖访问等问题。

## 总览介绍

![2_1.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/202309196509170253aed.png)

流量拓扑由`节点`、`路径`及一些操作组成:

- **① 节点:** 代表服务或资源，对应搜索条件中的`分组`，可以是某个容器服务、云服务器或者区域等
- **② 路径:** 代表服务或资源的方向，为`客户端`访问`服务端`
- **操作:** 可悬停或点击`节点`或`路径`
  - 悬停: 高亮`节点`或`路径`，查看指标量
  - 点击: 通过右滑框的形式查看`节点`或`路径`详情

![2_2.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/2023091965093c2239c31.png)

- **① 切换TOP数据:** 根据分组后的节点主指标数值大小进行降序排序
  - 注：若查询条件未分组，则无`切换TOP数据`功能
- **② 切换数据表:** 可切换数据表精准度，如 1m 为分钟级数据，1s 为秒级数据
- **③ 展开表格:** 点击后可展开或者关闭表格，使用详情，请参阅【展开表格】章节
- **④ 修改指标量:** 可进行指标的修改，使用详情，请参阅【修改指标量】章节
- **⑤ 设置:** 点击后可对`流量拓扑`进行设置，使用详情，请参阅【设置】章节
- **⑥ 编辑:** 为`视图`中的能力，可以对子视图进行修改编辑，如修改搜索条件、名称、更改保存视图位置、打开子视图原功能页面等，使用详情，请参阅【编辑】章节
- **⑦ 删除:** 为`视图`中的能力，若不需要在视图中展示该`流量拓扑`，可以点击删除按钮把该`流量拓扑`从视图中清除
- **⑧  手动补充资源关系模式:** 在该模式下，可手动为节点之间添加路径
- **⑨  瀑布/自由拓扑:** 支持切换拓扑的展示形式，自由拓扑一般用于节点数多路径复杂的场景；瀑布拓扑一般用于节点数少且路径单一的场景
- **⑩  自动排布:** 系统根据路径访问关系，按照树形结构对节点进行摆放
- **⑪  随机排布:** 系统按照星型结构对节点进行摆放
- **⑫  保存拓扑:** 为`视图`中的能力，当对`流量拓扑`进行修改后，可选择`保存拓扑`按钮来保存修改，如记忆时间范围、拓扑位置、拓扑配置、记忆变量模板取值
- **⑬ 图例:** 可打开图例查看图标、连线等表示的含义，使用详情，请参阅【图例】章节

## 悬停 TIP

![2_3.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/20230919650917049cd3c.png)

鼠标悬停在`节点`上时，自动高亮`节点`关联`路径`，悬停在`路径`上时，自动高亮`路径`关联的`节点`，同时通过 TIP 的形式查看指标量，TIP 可展示不同 `路径统计位置` 对应的指标量。

### 悬停展示指标量

![2_4.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/20230919650917062390f.png)

以鼠标悬停在`路径`上为例，为您介绍 TIP 展示内容。

- 第一行: 说明和图例展示区，图例说明如下:
  - 应用功能
    - A 应用: 代表通过应用插码的形式获取的指标量，目前可表示`信号源=OTel`的数据
    - S 系统: 代表通过 eBPF 的形式获取的指标量，目前可表达`信号源=eBPF`的数据
    - E 端点网络: 代表流量抓包（BPF）形式获取的指标量，目前表达客户端或服务端所在的网卡采集到的数据
    - M 中间网络: 代表流量抓包（BPF）形式获取的指标量，目前表达除客户端或服务端所在的网卡以外的位置采集到的数据
  - 网络功能: 所有的指标量都来源于流量抓包（BPF）
    - D 网卡: 表达客户端或服务端所在的网卡采集到的数据
    - K 容器节点: 表达容器节点网卡采集到的数据
    - H 宿主机: 表达宿主机网卡采集到的数据
    - M 中间网络: 表达除以上网卡以外采集到的数据
  - 角标：区分当前数据采集位置是在客户端还是服务端
    - C: 代表客户端
    - S: 代表服务端
- 第二行: 悬停`节点/路径`名称信息
- 其他: 指标展示区
  - 根据查看的数据位置，进而展示相关的指标数值
  - 最后一列为所有`路径统计位置`的差值，如可通过此行快速判断`发送流量`是否存在数据不一致的情况
  - 例：如下图所示，表示客户端的端点网络数据
![2_3_1.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/202309196509427e1c1c9.png)

## 设置

用户可点击齿轮来对`流量拓扑`进行设置

![2_5.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/202309196509170721de1.png)

- **名称全称显示:** 节点名称全称显示或缺省显示
- **下载CSV数据:** 支持下载`流量拓扑`的数据信息
- **查看API:**  查看生成该`流量拓扑`的接口信息
- **补齐所有关联数据:** 补齐所有关联关系的资源节点的路径
- **显示/隐藏特征关联关系:** 显示或隐藏特征关联关系的资源节点
  - 资源节点包含：IP、虚拟机、路由器、DHCP网关、POD、容器服务、容器节点、RDS、Redis、负载均衡器、NAT网关、工作负载、广域网IP等节点
- **缩略图:** 在`流量拓扑`中开启/关闭左下角的缩略图
- **颜色设置:** 设置当前`流量拓扑`颜色
- **显示主指标量:** 支持在`节点`和`路径`上显示主指标数值。`设置主指标量`使用详情，请参阅【修改指标量】章节

## 展开表格

点击`展开表格`按钮，以列表的形式展示`流量拓扑`中`节点`和`路径`的指标量，包含资源监控、路径监控以及路径差量表格等信息。

![2_6.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/2023091965091707f4009.png)

- 资源监控: 展示`流量拓扑`中所有节点的指标量
- 路径监控: 展示`流量拓扑`中所有路径的指标量
- 路径差量: 展示`流量拓扑`中所有路径的指标量在不同`路径统计位置`中的差值
- 搜索: 支持对表格数据快速搜索查找
- 设置: 设置列宽的展示方式，如均分列宽，按内容分配列宽

## 修改指标量

指标量是子视图重要的组成部分之一，DeepFlow 提供了快捷方式帮助用户进行快速选择指标量，可在下拉栏中选择要展示的指标数据。

![2_7.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/202309196509170932512.png)

- **① 指标名称:** 选中指标名称，可在子视图中显示该指标量
- **② 设为主指标:** 点击图标，该指标量设为主指标量，在`切换 TOP 数据`时，子视图按主指标数值大小进行排序
- **③ 高级设置:** 可进行指标量的增加、删除、修改操作，使用详情，请参阅【高级设置】章节
- **多选/单选:** 部分子视图支持，`多选`时子视图中 TIP 可显示多个指标量，`单选`时仅可显示一个指标量

### 高级设置

如对指标量更进一步设置，可通过点击`修改指标量 -> 高级设置`进入设置页面。如下图所示，支持用户添加或删除指标量、添加聚合函数、修改展示名称、设置阈值、选择指标量模板等操作。

![2_8.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/2023091965091709aebea.png)

- **① 选择模板:** 选择`指标量模板`可一键快速切换当前弹窗中的指标模板
- **② 一键清空:** 一键清空当前弹窗中全部指标量
- **③ 保存模板:** 对当前弹窗中的指标量的设置状态记忆保存为`指标量模板`
- **④ 指标量栏:** 点击输入框，弹出下拉框，可根据分类选择指标量
  - **聚合 - 一级算子:** 对指标量进行函数聚合操作，支持取平均值、加和、最大值、最小值等函数
  - **聚合 - 二级算子:** 根据`一级算子`得到数据进行二次计算
  - **名称:** 设置指标量展示的名称
  - **单位:** 设置指标量展示的单位
  - **阈值:** 设置指标量的阈值，当超过阈值时，`节点`或`路径`将变为红色进行提示
- **⑤ 启用/禁用指标:** 展示/隐藏对应的指标量
- **⑥ 添加指标量:** 当前弹窗中添加`④ 指标量栏`

## 编辑

为`视图`中的能力，可通过`编辑`按钮对`流量拓扑`进行修改。

![2_9.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/2023091965091bb83ac9a.png)

- **① 名称:** 子视图名称修改
- **② 视图:** 更换子视图所属视图
- **③ 另存为:** 修改后的子视图另外保存，同时不改变当前子视图信息
- **④ 搜索条件:** 修改子视图查询条件的修改
  - 编辑搜索条件: 使用详情，请参阅【[搜索](../../query/overview/)】章节

## 图例

点击`图例`可查看图标、连线所代表的含义。

![2_10.png](https://yunshan-guangzhou.oss-cn-beijing.aliyuncs.com/pub/pic/202309196509170b4c72e.png)
